//XW.AdminUI
function tabInit(){tabRegister(),$(".btnleft").on("click",btnLeftClick),$(".btnright").on("click",btnRightClick),$("#tabHome").on("click",btnHome),$("#tabXother").on("click",btnXother),$("#tabXall").on("click",btnXall),$(".menuItem").on("click",function(){return tabFind($(this).attr("href"),$(this).text()),!1}),$(".metismenu").find("a").not(".menuItem").each(function(){$(this).on("click",function(){$(".metismenu > li").not(".active").each(function(){$(this).find("a[aria-expanded='true']").attr("aria-expanded","false")}),$(".metismenu > li.active").children(":first").attr("aria-expanded","true");var a="fa fa-angle-";$(".metismenu > li").find("a[aria-expanded='true']").each(function(){$(this).find("i.fa-angle-left").removeClass(a+"left").addClass(a+"down")}),$(".metismenu > li").find("a[aria-expanded='false']").each(function(){$(this).find("i.fa-angle-down").removeClass(a+"down").addClass(a+"left")})})})}function tabRegister(){$.each($(".tablist a"),function(a,b){$(b).click(function(){tabClick(this)}),$(b).children("i.refresh").click(function(){btnIrefresh(this)}),$(b).children("i.close").click(function(){btnIclose(this)})})}function tabFind(a,b){var c=$(".tablist a[url='"+a+"']");c.length<1?(tabAdd({url:a,title:b}),tabFind(a,b)):c.trigger("click")}function tabAdd(a){var c,d,e,f,b={url:"",title:"",refresh:!0,close:!0};b=$.extend(b,a),c=$(".tablist"),d=parseInt($(".contents iframe:last").attr("name").replace("tabWin",""))+1,e=$("<a>").attr({id:"tab"+d,href:"javascript:;",url:b.url}).text(b.title),b.refresh&&e.append('<i class="fa fa-refresh refresh"></i>'),b.close&&e.append('<i class="fa fa-power-off close"></i>'),c.append(e),f='<iframe name="tabWin'+d+'" src="'+b.url+'" frameborder="0" url="'+b.url+'" seamless></iframe>',$(".contents").find("iframe:visible").hide(),$(".contents").append(f),layerLoading(),tabRegister()}function tabClick(a){$(a).hasClass("active")||($(a).addClass("active").siblings(".tablist a").removeClass("active"),$(a).siblings(".tablist a").children("i.refresh").hide(),$(a).children("i.refresh").show(),tabsClickMove(a),$(".contents").find("iframe:visible").hide(),$(".contents").find("iframe[url='"+$(a).attr("url")+"']").show())}function tabsClickMove(a){var h,b=getTabWidth($(a).prevAll()),c=getTabWidth($(a).nextAll()),d=getTabWidth($(".tabs").children(".btn")),e=$(".tabs").outerWidth(!0)-d,f=$(".tablist").outerWidth(),g=0;if(e>f)g=0;else if(c<=e-$(a).outerWidth(!0)-$(a).next().outerWidth(!0)){if(e-$(a).next().outerWidth(!0)>c)for(g=b,h=a;g-$(h).outerWidth()>$(".tablist").outerWidth()-e;)g-=$(h).prev().outerWidth(),h=$(h).prev()}else b>e-$(a).outerWidth(!0)-$(a).prev().outerWidth(!0)&&(g=b-$(a).prev().outerWidth(!0));$(".tablist").animate({marginLeft:0-g+"px"},"fast")}function btnLeftClick(){var e,f,a=Math.abs(parseInt($(".tablist").css("margin-left"))),b=getTabWidth($(".tabs").children(".btn")),c=$(".tabs").outerWidth(!0)-b,d=0;if(!($(".tablist").width()<c)){for(e=$(".tablist a:first"),f=0;f+$(e).outerWidth(!0)<=a;)f+=$(e).outerWidth(!0),e=$(e).next();if(f=0,getTabWidth($(e).prevAll())>c){for(;f+$(e).outerWidth(!0)<c&&e.length>0;)f+=$(e).outerWidth(!0),e=$(e).prev();d=getTabWidth($(e).prevAll())}$(".tablist").animate({marginLeft:0-d+"px"},"fast")}}function btnRightClick(){var e,f,a=Math.abs(parseInt($(".tablist").css("margin-left"))),b=getTabWidth($(".tabs").children(".btn")),c=$(".tabs").outerWidth(!0)-b,d=0;if(!($(".tablist").width()<c)){for(e=$(".tablist a:first"),f=0;f+$(e).outerWidth(!0)<=a;)f+=$(e).outerWidth(!0),e=$(e).next();for(f=0;f+$(e).outerWidth(!0)<c&&e.length>0;)f+=$(e).outerWidth(!0),e=$(e).next();d=getTabWidth($(e).prevAll()),d>0&&$(".tablist").animate({marginLeft:0-d+"px"},"fast")}}function btnHome(){$(".tablist a:first").trigger("click"),$(".tablist").css("margin-left","0"),setTimeout(function(){$(".configbox").hide()},1)}function btnXother(){$(".tablist a").not(":first").not(".active").each(function(){$(".contents").find("iframe[url='"+$(this).attr("url")+"']").remove(),$(this).remove()}),$(".tablist").css("margin-left","0"),setTimeout(function(){$(".configbox").hide()},1)}function btnXall(){$(".tablist a").not(":first").each(function(){$(this).remove()}),$(".contents iframe").not(":first").each(function(){$(this).remove()}),$(".tablist a:first").addClass("active"),$(".contents iframe:first").show(),$(".tablist").css("margin-left","0"),setTimeout(function(){$(".configbox").hide()},1)}function btnIrefresh(a){var b=$(a).parent(),c=$(".contents").find("iframe[url='"+b.attr("url")+"']");layerLoading(c)}function btnIclose(a){var b=$(a).parent();b.hasClass("active")&&b.prev().trigger("click"),$(".contents").find("iframe[url='"+b.attr("url")+"']").remove(),b.remove()}function getTabWidth(a){var b=0;return $(a).each(function(){b+=$(this).outerWidth(!0)}),b}